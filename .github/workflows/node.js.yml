name: Data Platform CI/CD

on:
  push:
    branches: ["main"]

jobs:
  build_and_check:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v3
        with:
          python-version: "3.10"

      - name: Check SQL file
        run: |
          if [ -f "data.sql" ]; then
            echo "SQL file exists! ðŸŸ¢"
          else
            echo "SQL missing! ðŸ”´"
            exit 1
          fi

      - name: Run Python check script
        run: python platform-check.py

      - name: Build Docker image
        run: docker build -t my-data-platform .

      - name: Run Docker container
        run: docker run my-data-platform
